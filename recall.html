<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Recall | Things I Learned</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="d-flex flex-column justify-content-center align-items-center min-vh-100">
  <div id="loading" class="spinner-border" role="status"></div>
  <div id="content" class="fs-1 text-center"></div>
  <div id="error" class="alert alert-danger mt-3 d-none"></div>
  <script type="module">
    const loading = document.getElementById('loading');
    const content = document.getElementById('content');
    const error = document.getElementById('error');
    const showError = msg => {
      error.textContent = msg;
      error.classList.remove('d-none');
    };
    const load = async () => {
      try {
        const res = await fetch('feed.xml');
        if (!res.ok) return showError(`HTTP ${res.status}`);
        const text = await res.text();
        const parser = new DOMParser();
        const xml = parser.parseFromString(text, 'application/xml');
        const items = [...xml.querySelectorAll('item')];
        if (!items.length) return showError('No items');
        const item = items[Math.floor(Math.random() * items.length)];
        const description = item.querySelector('description')?.textContent || '';
        const html = parser.parseFromString(description, 'text/html');
        const lis = [...html.querySelectorAll('li')];
        if (!lis.length) return showError('No list items');
        const li = lis[Math.floor(Math.random() * lis.length)];
        content.insertAdjacentHTML('afterbegin', li.innerHTML);
      } catch (e) {
        showError(e.message);
      } finally {
        loading.classList.add('d-none');
      }
    };
    load();

  </script>
</body>

</html>
